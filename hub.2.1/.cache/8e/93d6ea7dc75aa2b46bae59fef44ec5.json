{"id":"lvKF","dependencies":[{"name":"/home/skip/Software/HubAndNeso/.babelrc","includedInParent":true,"mtime":1576094107943},{"name":"/home/skip/Software/HubAndNeso/hub.2.1/package.json","includedInParent":true,"mtime":1577317183049}],"generated":{"js":"\"use strict\";function e(e,r){if(!(e instanceof r))throw new TypeError(\"Cannot call a class as a function\")}function r(e,r){for(var n=0;n<r.length;n++){var o=r[n];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function n(e,n,o){return n&&r(e.prototype,n),o&&r(e,o),e}Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0;var o=function(){function r(){e(this,r)}return n(r,null,[{key:\"ReturnUData\",value:function(e,r){return new Promise(function(n,o){var a=e;a||(a=\"jbaker\"),\"jbaker\"===e&&r&&(a=r),n(\"jbaker\"===a?{error:!1,uData:{u:\"jbaker\",o:\"sp1\",user:{email:\"jbaker@mos.org\",displayName:\"James Baker\",account:\"jbaker\",accountLong:\"i:0#.f|membership|jbaker@mos.org\",roles:[\"admin\",\"componentGrpAdmin\",\"o365GlobalAdmin\"],preferences:{darkMode:!0,pinned:[\"Network Access Request\",\"Equipment Loan Request\"]}}}}:{error:!1,uData:{u:\"jbaker\",o:\"sp1\",user:{email:\"sp1@mos.org\",displayName:\"Hub Tester1\",account:\"sp1\",accountLong:\"i:0#.f|membership|sp1@mos.org\",roles:[],preferences:{darkMode:!1,pinned:[]}}}})})}}]),r}();exports.default=o;"},"sourceMaps":{"js":{"mappings":[{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":0}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":13}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":22}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":24}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":26}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":29}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":34}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":47}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":50}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":56}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":60}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":70}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":107}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":116}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":118}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":120}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":123}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":127}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":131}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":133}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":135}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":137}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":139}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":146}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":150}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":151}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":155}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":157}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":159}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":162}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":164}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":175}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":177}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":190}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":192}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":194}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":208}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":210}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":220}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":224}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":226}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":236}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":239}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":246}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":261}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":263}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":265}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":269}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":273}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":282}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":284}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":286}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":288}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":291}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":298}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":301}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":303}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":305}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":315}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":318}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":321}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":323}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":325}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":328}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":330}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":337}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":352}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":360}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":373}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":374}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":381}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":385}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":393}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":406}},{"source":"../services/User.js","name":"User","original":{"line":17,"column":21},"generated":{"line":1,"column":408}},{"source":"../services/User.js","name":"User","original":{"line":17,"column":21},"generated":{"line":1,"column":412}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":414}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":425}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":434}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":438}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":440}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":445}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":448}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":455}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":457}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":459}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":464}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":465}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":466}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":470}},{"source":"../services/User.js","name":"u","original":{"line":72,"column":20},"generated":{"line":1,"column":484}},{"source":"../services/User.js","name":"u","original":{"line":72,"column":20},"generated":{"line":1,"column":490}},{"source":"../services/User.js","name":"u","original":{"line":72,"column":20},"generated":{"line":1,"column":499}},{"source":"../services/User.js","name":"o","original":{"line":72,"column":23},"generated":{"line":1,"column":501}},{"source":"../services/User.js","original":{"line":74,"column":9},"generated":{"line":1,"column":504}},{"source":"../services/User.js","original":{"line":74,"column":9},"generated":{"line":1,"column":511}},{"source":"../services/User.js","name":"Promise","original":{"line":74,"column":13},"generated":{"line":1,"column":515}},{"source":"../services/User.js","original":{"line":74,"column":21},"generated":{"line":1,"column":523}},{"source":"../services/User.js","name":"resolve","original":{"line":74,"column":22},"generated":{"line":1,"column":532}},{"source":"../services/User.js","name":"reject","original":{"line":74,"column":31},"generated":{"line":1,"column":534}},{"source":"../services/User.js","name":"userToReturn","original":{"line":75,"column":7},"generated":{"line":1,"column":537}},{"source":"../services/User.js","name":"userToReturn","original":{"line":75,"column":7},"generated":{"line":1,"column":541}},{"source":"../services/User.js","name":"u","original":{"line":75,"column":22},"generated":{"line":1,"column":543}},{"source":"../services/User.js","name":"userToReturn","original":{"line":76,"column":8},"generated":{"line":1,"column":545}},{"source":"../services/User.js","name":"userToReturn","original":{"line":77,"column":4},"generated":{"line":1,"column":549}},{"source":"../services/User.js","original":{"line":77,"column":19},"generated":{"line":1,"column":551}},{"source":"../services/User.js","original":{"line":79,"column":13},"generated":{"line":1,"column":561}},{"source":"../services/User.js","name":"u","original":{"line":79,"column":7},"generated":{"line":1,"column":572}},{"source":"../services/User.js","name":"o","original":{"line":79,"column":25},"generated":{"line":1,"column":575}},{"source":"../services/User.js","name":"userToReturn","original":{"line":80,"column":4},"generated":{"line":1,"column":579}},{"source":"../services/User.js","name":"o","original":{"line":80,"column":19},"generated":{"line":1,"column":581}},{"source":"../services/User.js","name":"resolve","original":{"line":84,"column":4},"generated":{"line":1,"column":584}},{"source":"../services/User.js","original":{"line":83,"column":24},"generated":{"line":1,"column":586}},{"source":"../services/User.js","name":"userToReturn","original":{"line":83,"column":7},"generated":{"line":1,"column":597}},{"source":"../services/User.js","original":{"line":84,"column":12},"generated":{"line":1,"column":599}},{"source":"../services/User.js","name":"error","original":{"line":85,"column":5},"generated":{"line":1,"column":600}},{"source":"../services/User.js","original":{"line":85,"column":12},"generated":{"line":1,"column":607}},{"source":"../services/User.js","name":"uData","original":{"line":86,"column":5},"generated":{"line":1,"column":609}},{"source":"../services/User.js","original":{"line":86,"column":12},"generated":{"line":1,"column":615}},{"source":"../services/User.js","name":"u","original":{"line":87,"column":6},"generated":{"line":1,"column":616}},{"source":"../services/User.js","original":{"line":87,"column":9},"generated":{"line":1,"column":618}},{"source":"../services/User.js","name":"o","original":{"line":88,"column":6},"generated":{"line":1,"column":627}},{"source":"../services/User.js","original":{"line":88,"column":9},"generated":{"line":1,"column":629}},{"source":"../services/User.js","name":"user","original":{"line":89,"column":6},"generated":{"line":1,"column":635}},{"source":"../services/User.js","original":{"line":89,"column":12},"generated":{"line":1,"column":640}},{"source":"../services/User.js","name":"email","original":{"line":90,"column":7},"generated":{"line":1,"column":641}},{"source":"../services/User.js","original":{"line":90,"column":14},"generated":{"line":1,"column":647}},{"source":"../services/User.js","name":"displayName","original":{"line":91,"column":7},"generated":{"line":1,"column":664}},{"source":"../services/User.js","original":{"line":91,"column":20},"generated":{"line":1,"column":676}},{"source":"../services/User.js","name":"account","original":{"line":92,"column":7},"generated":{"line":1,"column":690}},{"source":"../services/User.js","original":{"line":92,"column":16},"generated":{"line":1,"column":698}},{"source":"../services/User.js","name":"accountLong","original":{"line":93,"column":7},"generated":{"line":1,"column":707}},{"source":"../services/User.js","original":{"line":93,"column":20},"generated":{"line":1,"column":719}},{"source":"../services/User.js","name":"roles","original":{"line":94,"column":7},"generated":{"line":1,"column":754}},{"source":"../services/User.js","original":{"line":94,"column":14},"generated":{"line":1,"column":760}},{"source":"../services/User.js","original":{"line":95,"column":8},"generated":{"line":1,"column":761}},{"source":"../services/User.js","original":{"line":96,"column":8},"generated":{"line":1,"column":769}},{"source":"../services/User.js","original":{"line":97,"column":8},"generated":{"line":1,"column":789}},{"source":"../services/User.js","name":"preferences","original":{"line":99,"column":7},"generated":{"line":1,"column":808}},{"source":"../services/User.js","original":{"line":99,"column":20},"generated":{"line":1,"column":820}},{"source":"../services/User.js","name":"darkMode","original":{"line":100,"column":8},"generated":{"line":1,"column":821}},{"source":"../services/User.js","original":{"line":100,"column":18},"generated":{"line":1,"column":831}},{"source":"../services/User.js","name":"pinned","original":{"line":101,"column":8},"generated":{"line":1,"column":833}},{"source":"../services/User.js","original":{"line":101,"column":16},"generated":{"line":1,"column":840}},{"source":"../services/User.js","original":{"line":102,"column":9},"generated":{"line":1,"column":841}},{"source":"../services/User.js","original":{"line":103,"column":9},"generated":{"line":1,"column":866}},{"source":"../services/User.js","original":{"line":110,"column":12},"generated":{"line":1,"column":896}},{"source":"../services/User.js","name":"error","original":{"line":111,"column":5},"generated":{"line":1,"column":897}},{"source":"../services/User.js","original":{"line":111,"column":12},"generated":{"line":1,"column":904}},{"source":"../services/User.js","name":"uData","original":{"line":112,"column":5},"generated":{"line":1,"column":906}},{"source":"../services/User.js","original":{"line":112,"column":12},"generated":{"line":1,"column":912}},{"source":"../services/User.js","name":"u","original":{"line":113,"column":6},"generated":{"line":1,"column":913}},{"source":"../services/User.js","original":{"line":113,"column":9},"generated":{"line":1,"column":915}},{"source":"../services/User.js","name":"o","original":{"line":114,"column":6},"generated":{"line":1,"column":924}},{"source":"../services/User.js","original":{"line":114,"column":9},"generated":{"line":1,"column":926}},{"source":"../services/User.js","name":"user","original":{"line":115,"column":6},"generated":{"line":1,"column":932}},{"source":"../services/User.js","original":{"line":115,"column":12},"generated":{"line":1,"column":937}},{"source":"../services/User.js","name":"email","original":{"line":116,"column":7},"generated":{"line":1,"column":938}},{"source":"../services/User.js","original":{"line":116,"column":14},"generated":{"line":1,"column":944}},{"source":"../services/User.js","name":"displayName","original":{"line":117,"column":7},"generated":{"line":1,"column":958}},{"source":"../services/User.js","original":{"line":117,"column":20},"generated":{"line":1,"column":970}},{"source":"../services/User.js","name":"account","original":{"line":118,"column":7},"generated":{"line":1,"column":984}},{"source":"../services/User.js","original":{"line":118,"column":16},"generated":{"line":1,"column":992}},{"source":"../services/User.js","name":"accountLong","original":{"line":119,"column":7},"generated":{"line":1,"column":998}},{"source":"../services/User.js","original":{"line":119,"column":20},"generated":{"line":1,"column":1010}},{"source":"../services/User.js","name":"roles","original":{"line":120,"column":7},"generated":{"line":1,"column":1042}},{"source":"../services/User.js","original":{"line":120,"column":14},"generated":{"line":1,"column":1048}},{"source":"../services/User.js","name":"preferences","original":{"line":121,"column":7},"generated":{"line":1,"column":1051}},{"source":"../services/User.js","original":{"line":121,"column":20},"generated":{"line":1,"column":1063}},{"source":"../services/User.js","name":"darkMode","original":{"line":122,"column":8},"generated":{"line":1,"column":1064}},{"source":"../services/User.js","original":{"line":122,"column":18},"generated":{"line":1,"column":1074}},{"source":"../services/User.js","name":"pinned","original":{"line":123,"column":8},"generated":{"line":1,"column":1076}},{"source":"../services/User.js","original":{"line":123,"column":16},"generated":{"line":1,"column":1083}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":1097}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":1099}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":1102}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":1110}},{"source":"../services/User.js","original":{"line":229,"column":2},"generated":{"line":1,"column":1118}}],"sources":{"../services/User.js":"/**\n * @name User Service\n * @module\n * @category Services\n * @description Fetch and return data about user.\n * \n * @todo Refactor into module instead of class\n * @todo Fetch live data\n * @todo Assign roles in cloud\n * @todo Set mosManager as a role in cloud\n */\n\n// import pnp, { Web } from 'sp-pnp-js';\n// import MOSUtilities from './MOSUtilities';\n// import NesoHTTPClient from './NesoHTTPClient';\n\nexport default class User {\n\t/* static ReturnGSEConfig() {\n\t\tconst gseConfigWeb = new Web('https://bmos.sharepoint.com/sites/hr-service-config');\n\t\treturn gseConfigWeb.lists.getByTitle('SWFList').items\n\t\t\t.select('AllRequestData')\n\t\t\t.get();\n\t}\n\tstatic SetComponentGroupID() {\n\t\t// set component group ID\n\t\tif (window.mData && window.mData.axle && window.mData.axle === 1) {\n\t\t\twindow.mData.componentGroupID = 1;\n\t\t}\n\t\tif (window.mData && window.mData.community && window.mData.community === 1) {\n\t\t\twindow.mData.componentGroupID = 2;\n\t\t}\n\t\tif (window.mData && window.mData.swf && window.mData.swf === 1) {\n\t\t\twindow.mData.componentGroupID = 3;\n\t\t}\n\t\tif (window.mData && window.mData.visualization && window.mData.visualization === 1) {\n\t\t\twindow.mData.componentGroupID = 4;\n\t\t}\n\t}\n\tstatic ReturnComponentGroupAdminData() {\n\t\t// set component group ID\n\t\tthis.SetComponentGroupID();\n\t\t// get and retrieve the data\n\t\tconst gseComponentGroupLogWeb = new Web('https://bmos.sharepoint.com/sites/hubprod/');\n\t\treturn gseComponentGroupLogWeb.lists.getByTitle('Component Group Log').items\n\t\t\t// .select('GroupAdminAccess')\n\t\t\t.select('GroupAdminAccess/Name')\n\t\t\t.expand('GroupAdminAccess')\n\t\t\t.filter(`ComponentGroupID eq '${window.mData.componentGroupID}'`)\n\t\t\t.get();\n\t}\n\tstatic ReturnThisUserIsComponentGroupAdmin() {\n\t\t// return a new promise\n\t\treturn new Promise((resolve, reject) => {\n\t\t\t// get a promise to retrieve the component group admin data\n\t\t\tthis.ReturnComponentGroupAdminData()\n\t\t\t\t// if the promise was resolved with the data\n\t\t\t\t.then((result) => {\n\t\t\t\t\tconst groupAdminAccess = []; \n\t\t\t\t\tresult[0].GroupAdminAccess.forEach((user) => {\n\t\t\t\t\t\tgroupAdminAccess.push(user.Name);\n\t\t\t\t\t});\n\t\t\t\t\tresolve(groupAdminAccess);\n\t\t\t\t})\n\t\t\t\t// if the promise was rejected with an error\n\t\t\t\t.catch((error) => {\n\t\t\t\t\treject(error);\n\t\t\t\t});\n\t\t});\n\t} */\n\n\n\tstatic ReturnUData(u, o) {\n\t\t// return a new promise\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet userToReturn = u;\n\t\t\tif (!userToReturn) {\n\t\t\t\tuserToReturn = 'jbaker';\n\t\t\t}\n\t\t\tif (u === 'jbaker' && o) {\n\t\t\t\tuserToReturn = o;\n\t\t\t}\n\n\t\t\tif (userToReturn === 'jbaker') {\n\t\t\t\tresolve({\n\t\t\t\t\terror: false,\n\t\t\t\t\tuData: {\n\t\t\t\t\t\tu: 'jbaker',\n\t\t\t\t\t\to: 'sp1',\n\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\temail: 'jbaker@mos.org',\n\t\t\t\t\t\t\tdisplayName: 'James Baker',\n\t\t\t\t\t\t\taccount: 'jbaker',\n\t\t\t\t\t\t\taccountLong: 'i:0#.f|membership|jbaker@mos.org',\n\t\t\t\t\t\t\troles: [\n\t\t\t\t\t\t\t\t'admin',\n\t\t\t\t\t\t\t\t'componentGrpAdmin',\n\t\t\t\t\t\t\t\t'o365GlobalAdmin',\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tpreferences: {\n\t\t\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\t\t\tpinned: [\n\t\t\t\t\t\t\t\t\t'Network Access Request',\n\t\t\t\t\t\t\t\t\t'Equipment Loan Request',\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tresolve({\n\t\t\t\t\terror: false,\n\t\t\t\t\tuData: {\n\t\t\t\t\t\tu: 'jbaker',\n\t\t\t\t\t\to: 'sp1',\n\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\temail: 'sp1@mos.org',\n\t\t\t\t\t\t\tdisplayName: 'Hub Tester1',\n\t\t\t\t\t\t\taccount: 'sp1',\n\t\t\t\t\t\t\taccountLong: 'i:0#.f|membership|sp1@mos.org',\n\t\t\t\t\t\t\troles: [],\n\t\t\t\t\t\t\tpreferences: {\n\t\t\t\t\t\t\t\tdarkMode: false,\n\t\t\t\t\t\t\t\tpinned: [],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t\n\t\t\t/* // collect data async from multiple sources\n\t\t\tconst userDataQueryPromises = [\n\t\t\t\tpnp.sp.web.currentUser.get(),\n\t\t\t\tNesoHTTPClient\n\t\t\t\t\t.ReturnNesoData('https://neso.mos.org/activeDirectory/managers'),\n\t\t\t\tthis.ReturnThisUserIsComponentGroupAdmin(),\n\t\t\t\tthis.ReturnGSEConfig(),\n\t\t\t\tNesoHTTPClient\n\t\t\t\t\t.ReturnNesoData('https://neso.mos.org/activeDirectory/divDept/div/Human Resources & Volunteer Services'),\n\t\t\t];\n\t\t\t// wait for all queries to be completed\n\t\t\tPromise.all(userDataQueryPromises)\n\t\t\t// if the queries returned the data\n\t\t\t\t.then((resultsArray) => {\n\t\t\t\t\t// extract data from responses\n\t\t\t\t\tconst uData = {\n\t\t\t\t\t\temail: resultsArray[0].Email,\n\t\t\t\t\t\tdisplayName: resultsArray[0].Title,\n\t\t\t\t\t};\n\t\t\t\t\tuData.account =\n\t\t\t\t\t\t\tMOSUtilities.ReplaceAll('i:0#.f\\\\|membership\\\\|', '', MOSUtilities.ReplaceAll('@mos.org', '', resultsArray[0].LoginName.toLowerCase()));\n\t\t\t\t\tuData.accountLong = resultsArray[0].LoginName.toLowerCase();\n\t\t\t\t\tuData.roles = [];\n\t\t\t\t\t// hard code some roles for service accounts\n\t\t\t\t\tif (uData.account === 'sp1') {\n\t\t\t\t\t\tuData.roles.push('pafAdmin');\n\t\t\t\t\t\tuData.roles.push('earAdmin');\n\t\t\t\t\t\tuData.roles.push('manager');\n\t\t\t\t\t\tuData.roles.push('gseManager');\n\t\t\t\t\t}\n\t\t\t\t\tif (uData.account === 'sp2') {\n\t\t\t\t\t\tuData.roles.push('pafAdmin');\n\t\t\t\t\t\tuData.roles.push('earAdmin');\n\t\t\t\t\t}\n\t\t\t\t\tif (uData.account === 'sp3') {\n\t\t\t\t\t\tuData.roles.push('manager');\n\t\t\t\t\t\tuData.roles.push('gseManager');\n\t\t\t\t\t}\n\t\t\t\t\t// handle normal accounts\n\t\t\t\t\t// for each manager returned\n\t\t\t\t\tresultsArray[1].forEach((manager) => {\n\t\t\t\t\t\t// if the manager's account is the current user's account\n\t\t\t\t\t\tif (manager.account === uData.account) {\n\t\t\t\t\t\t\t// push manager roles to uData\n\t\t\t\t\t\t\tuData.roles.push('manager');\n\t\t\t\t\t\t\tuData.roles.push('gseManager');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t// for each componentGrpAdmin returned\n\t\t\t\t\tresultsArray[2].forEach((componentGrpAdmin) => {\n\t\t\t\t\t\tif (componentGrpAdmin === uData.accountLong) {\n\t\t\t\t\t\t\t// push admin and componentGrpAdmin roles to uData\n\t\t\t\t\t\t\tuData.roles.push('admin');\n\t\t\t\t\t\t\tuData.roles.push('componentGrpAdmin');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t// extract GSE config data\n\t\t\t\t\tlet gseConfigString = resultsArray[3][0].AllRequestData;\n\t\t\t\t\t// eslint-disable-next-line no-control-regex\n\t\t\t\t\tconst regexOne = new RegExp('\\r', 'g');\n\t\t\t\t\t// eslint-disable-next-line no-control-regex\n\t\t\t\t\tconst regexTwo = new RegExp('\\n', 'g');\n\t\t\t\t\tgseConfigString = gseConfigString.replace(regexOne, \"'\");\n\t\t\t\t\tgseConfigString = gseConfigString.replace(regexTwo, \"'\");\n\t\t\t\t\tconst gseConfig = JSON.parse(gseConfigString);\n\t\t\t\t\t// for each hr admin returned\n\t\t\t\t\tgseConfig['HR-Admins'].forEach((gseHRAdmin) => {\n\t\t\t\t\t\t// if the hr admin's account is the current user's account\n\t\t\t\t\t\tif (gseHRAdmin.account === uData.accountLong) {\n\t\t\t\t\t\t\t// push gseHRAdmin role to uData\n\t\t\t\t\t\t\tuData.roles.push('gseHRAdmin');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t// for each job admin returned\n\t\t\t\t\tgseConfig['Job-Admins'].forEach((gseJobAdmin) => {\n\t\t\t\t\t\t// if the job admin's account is the current user's account\n\t\t\t\t\t\tif (gseJobAdmin.account === uData.accountLong) {\n\t\t\t\t\t\t\t// push gseJobAdmin role to uData\n\t\t\t\t\t\t\tuData.roles.push('gseJobAdmin');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t// for each hrvsMember returned\n\t\t\t\t\tresultsArray[4].forEach((hrvsMember) => {\n\t\t\t\t\t\t// if the hrvsMember's account is the current user's account\n\t\t\t\t\t\tif (hrvsMember.account === uData.account) {\n\t\t\t\t\t\t\t// push manager and hrvsMember roles to uData\n\t\t\t\t\t\t\tuData.roles.push('pafAdmin');\n\t\t\t\t\t\t\tuData.roles.push('earAdmin');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t// resolve this promise with the user data\n\t\t\t\t\tconsole.log('uData');\n\t\t\t\t\tconsole.log(uData);\n\t\t\t\t\tresolve(uData);\n\t\t\t\t})\n\t\t\t// if 1+ queries returned an error, reject this promise with the error\n\t\t\t\t.catch((error) => { reject(error); }); */\n\t\t});\n\t}\n}\n"},"lineCount":null}},"error":null,"hash":"271dac11b1f5f61e43332e5004716075","cacheData":{"env":{}}}